<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>FlatForest Notebook &#8212; AlgoTree 0.8.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css?v=def86cc0" />
    
    <script src="_static/documentation_options.js?v=486e5634"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Expression Trees and Evaluation" href="expr_trees_nb.html" />
    <link rel="prev" title="AlgoTree: Comprehensive Tutorial" href="tutorial.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="expr_trees_nb.html" title="Expression Trees and Evaluation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="AlgoTree: Comprehensive Tutorial"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">AlgoTree 0.8.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="docutils literal notranslate"><span class="pre">FlatForest</span> <span class="pre">Notebook</span></code></a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="flatforest-notebook">
<h1><code class="docutils literal notranslate"><span class="pre">FlatForest</span> <span class="pre">Notebook</span></code><a class="headerlink" href="#flatforest-notebook" title="Link to this heading">¶</a></h1>
<p>In this notebook, we explore the <code class="docutils literal notranslate"><span class="pre">FlatForest</span></code> data structure, which is
a forest structure with a flat (non-nested) data structure. It is a
<code class="docutils literal notranslate"><span class="pre">dict</span></code> with special methods to access the root nodes and other
tree-like operations.</p>
<p>The main implementation detail is the proxy class <code class="docutils literal notranslate"><span class="pre">FlatForestNode</span></code>,
which allows us to access the <code class="docutils literal notranslate"><span class="pre">dict</span></code> with a node-centric abstraction.
This allows us to implement tree-like operations in a flat data
structure. As a proxy, it also modifies the <code class="docutils literal notranslate"><span class="pre">dict</span></code> in place, so it is
a mutable data structure.</p>
<p>Let’s load the required libraries and create a <code class="docutils literal notranslate"><span class="pre">FlatForest</span></code> data
structure using the node interface.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">AlgoTree.flat_forest_node</span> <span class="kn">import</span> <span class="n">FlatForestNode</span>
<span class="kn">from</span> <span class="nn">AlgoTree.flat_forest</span> <span class="kn">import</span> <span class="n">FlatForest</span>
<span class="kn">from</span> <span class="nn">AlgoTree.tree_converter</span> <span class="kn">import</span> <span class="n">TreeConverter</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Markdown</span>
<span class="kn">from</span> <span class="nn">AlgoTree.pretty_tree</span> <span class="kn">import</span> <span class="n">pretty_tree</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="c1">#from AlgoTree.treenode import TreeNode</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>


<span class="k">def</span> <span class="nf">monotext</span><span class="p">(</span><span class="n">txt</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;pre&gt;</span><span class="si">{</span><span class="n">txt</span><span class="si">}</span><span class="s2">&lt;/pre&gt;&quot;</span><span class="p">))</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
    <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
    <span class="s2">&quot;3&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
    <span class="s2">&quot;4&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
    <span class="s2">&quot;5&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
    <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for A&quot;</span><span class="p">,</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="kc">None</span> <span class="p">},</span>
    <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for B&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for C&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for D&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;E&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for E&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;F&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for F&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for G&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for H&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;I&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for I&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;J&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for J&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;K&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for K&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for L&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;M&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for M&quot;</span> <span class="p">},</span>
<span class="p">}</span>

<span class="n">forest</span> <span class="o">=</span> <span class="n">FlatForest</span><span class="p">()</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">par_key</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;parent&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">par_key</span><span class="p">,</span> <span class="n">forest</span><span class="o">=</span><span class="n">forest</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">value</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">payload</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ValueError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KeyError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span> <span class="kc">None</span>

<span class="mi">2</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span> <span class="mi">1</span>

<span class="mi">3</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span> <span class="mi">1</span>

<span class="mi">4</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span> <span class="mi">3</span>

<span class="mi">5</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span> <span class="mi">3</span>

<span class="n">A</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for A&#39;</span><span class="p">}</span> <span class="kc">None</span>

<span class="n">B</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for B&#39;</span><span class="p">}</span> <span class="n">A</span>

<span class="n">C</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for C&#39;</span><span class="p">}</span> <span class="n">A</span>

<span class="n">D</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for D&#39;</span><span class="p">}</span> <span class="n">C</span>

<span class="n">E</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for E&#39;</span><span class="p">}</span> <span class="n">C</span>

<span class="n">F</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for F&#39;</span><span class="p">}</span> <span class="n">E</span>

<span class="n">G</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for G&#39;</span><span class="p">}</span> <span class="n">E</span>

<span class="n">H</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for H&#39;</span><span class="p">}</span> <span class="n">B</span>

<span class="n">I</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for I&#39;</span><span class="p">}</span> <span class="n">A</span>

<span class="n">J</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for J&#39;</span><span class="p">}</span> <span class="n">I</span>

<span class="n">K</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for K&#39;</span><span class="p">}</span> <span class="n">G</span>

<span class="n">L</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for L&#39;</span><span class="p">}</span> <span class="n">G</span>

<span class="n">M</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for M&#39;</span><span class="p">}</span> <span class="n">C</span>
</pre></div>
</div>
<p>It’s easy to regenerate any JSON files that may have been used to
generate the <code class="docutils literal notranslate"><span class="pre">FlatForest</span></code> object. So, JSON is a good format for
storing and transmitting trees. And, of course, <code class="docutils literal notranslate"><span class="pre">FlatForest</span></code> <em>is</em> a
dictionary. Of course, if we store an object that has no serializable
representation, it cannot be stored in JSON.</p>
<p>Let’s do something similar, but using the <code class="docutils literal notranslate"><span class="pre">FlatForest</span></code>’s <code class="docutils literal notranslate"><span class="pre">dict</span></code> or
<code class="docutils literal notranslate"><span class="pre">json</span></code> constructor. This is more direct and makes it explicit what
data the tree is providing a <em>view</em> of. After all, the <code class="docutils literal notranslate"><span class="pre">FlatForest</span></code> is
itself just a <code class="docutils literal notranslate"><span class="pre">dict</span></code> of a particular shape.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load a forest from data</span>
<span class="n">forest2</span> <span class="o">=</span> <span class="n">FlatForest</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="c1"># load a forest from a forest</span>
<span class="n">forest3</span> <span class="o">=</span> <span class="n">FlatForest</span><span class="p">(</span><span class="n">forest</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">forest</span> <span class="o">==</span> <span class="n">forest2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">forest</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">forest2</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">forest</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">forest3</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">forest2</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">forest3</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">False</span>
<span class="kc">False</span>
<span class="kc">True</span>
<span class="kc">False</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forest</span><span class="o">.</span><span class="n">logical_root_names</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;__DETACHED__&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">detached</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">__DETACHED__</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{},</span> <span class="n">root</span><span class="o">=</span><span class="n">__DETACHED__</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="n">new_forest</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">forest</span><span class="p">)</span>
<span class="n">new_forest</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">root</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>If we try to detach a node that was already detached, we get a
<code class="docutils literal notranslate"><span class="pre">KeyError</span></code>. Note that this can happen in two ways:</p>
<ol class="arabic simple">
<li><p>The node was detached and then we try to detach it again.</p></li>
<li><p>The node was detached and then we try to detach a child of it.</p></li>
</ol>
<p>Any child of a detached node is also detached, so we can’t detach a
child of a detached node.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">new_forest</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KeyError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forest</span><span class="o">.</span><span class="n">as_tree</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">__ROOT__</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{},</span> <span class="n">root</span><span class="o">=</span><span class="n">__ROOT__</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forest</span><span class="o">.</span><span class="n">preferred_root</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">subtree</span><span class="p">()))</span>
<span class="n">forest</span><span class="o">.</span><span class="n">preferred_root</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">subtree</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">subtree</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1
├───── 2
└───── 3
       ├───── 4
       └───── 5

A
├───── B
│      └───── H
├───── C
│      ├───── D
│      ├───── E
│      │      ├───── F
│      │      └───── G
│      │             ├───── K
│      │             └───── L
│      └───── M
└───── I
       └───── J

C
├───── D
├───── E
│      ├───── F
│      └───── G
│             ├───── K
│             └───── L
└───── M
</pre></div>
</div>
<p>For visualizing trees, we can use the <code class="docutils literal notranslate"><span class="pre">PrettyTree</span></code> class and the
<code class="docutils literal notranslate"><span class="pre">pretty_tree</span></code> function. The <code class="docutils literal notranslate"><span class="pre">PrettyTree</span></code> class is a simple tree data
structure that can be used to visualize trees in pretty text format,
optionally with the ability to mark nodes for highlighting.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">subtree</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">),</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">],</span> <span class="n">node_details</span><span class="o">=</span><span class="k">lambda</span> <span class="n">node</span><span class="p">:</span> <span class="n">node</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]))</span>
</pre></div>
</div>
<pre>A ◄ Data for A 🔵
├───── B ◄ Data for B
│      └───── H ◄ Data for H
├───── C ◄ Data for C
│      ├───── D ◄ Data for D
│      ├───── E ◄ Data for E
│      │      ├───── F ◄ Data for F
│      │      └───── G ◄ Data for G 🟣
│      │             ├───── K ◄ Data for K
│      │             └───── L ◄ Data for L
│      └───── M ◄ Data for M
└───── I ◄ Data for I
       └───── J ◄ Data for J
</pre><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">subtree</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">),</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<pre>A
├───── B
│      └───── H 🟡
├───── C
│      ├───── D ⭕
│      ├───── E
│      │      ├───── F
│      │      └───── G
│      │             ├───── K
│      │             └───── L
│      └───── M
└───── I
       └───── J
</pre><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">AlgoTree</span> <span class="kn">import</span> <span class="n">utils</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">node_stats</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">subtree</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;node_info&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ancestors&#39;</span><span class="p">:</span> <span class="p">[],</span>
               <span class="s1">&#39;children&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">],</span>
               <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
               <span class="s1">&#39;descendants&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">],</span>
               <span class="s1">&#39;is_internal&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
               <span class="s1">&#39;is_leaf&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
               <span class="s1">&#39;is_root&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
               <span class="s1">&#39;leaves_under&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">],</span>
               <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
               <span class="s1">&#39;parent&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
               <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">],</span>
               <span class="s1">&#39;payload&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for C&#39;</span><span class="p">},</span>
               <span class="s1">&#39;root_distance&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
               <span class="s1">&#39;siblings&#39;</span><span class="p">:</span> <span class="p">[],</span>
               <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s2">&quot;&lt;class &#39;AlgoTree.flat_forest_node.FlatForestNode&#39;&gt;&quot;</span><span class="p">},</span>
 <span class="s1">&#39;subtree_info&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                  <span class="s1">&#39;leaves&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">],</span>
                  <span class="s1">&#39;root&#39;</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">FlatForest</span></code> class provides a <strong>view</strong> of a <code class="docutils literal notranslate"><span class="pre">dict</span></code> object as a
forest. We do not modify the <code class="docutils literal notranslate"><span class="pre">dict</span></code> passed into it (and you can create
a dict through the <code class="docutils literal notranslate"><span class="pre">FlatForest</span></code> API). Since it’s just a view of a
<code class="docutils literal notranslate"><span class="pre">dict</span></code> we have all the normal operations on it that we would have on a
<code class="docutils literal notranslate"><span class="pre">dict</span></code> object.</p>
<p><code class="docutils literal notranslate"><span class="pre">FlatForest</span></code> also implements the concept of a node, which is a view of
a particular node in our node-centric API. In order to do this, we
specify a preferred root node, which by default is the first root node
in the forest. This is the node that will be used as the root node in
the <code class="docutils literal notranslate"><span class="pre">FlatForestNode</span></code> API. If you want to change the root node, you can
do so by calling <code class="docutils literal notranslate"><span class="pre">FlatForest.preferred_root</span></code> with the name of the node
you want to be the preferred root.</p>
<p>We also provide as <code class="docutils literal notranslate"><span class="pre">as_tree</span></code> method that unifies any <code class="docutils literal notranslate"><span class="pre">dict</span></code> object
representing a flat forest structure into a flat forest structure with
just a single root node, where all the root nodes are children of this
root node. This is no longer a view, however, as we return a new
<code class="docutils literal notranslate"><span class="pre">dict</span></code> object.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">forest</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">])</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">forest</span><span class="o">.</span><span class="n">subtree</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="s2">&quot;parent&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for C&#39;</span><span class="p">,</span> <span class="s1">&#39;parent&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">}</span>
<span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for C&#39;</span><span class="p">},</span> <span class="n">root</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">])</span>
<span class="n">A</span>
<span class="p">[</span><span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">D</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for D&#39;</span><span class="p">},</span> <span class="n">root</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[]),</span> <span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">E</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for E&#39;</span><span class="p">},</span> <span class="n">root</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">]),</span> <span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for M&#39;</span><span class="p">},</span> <span class="n">root</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[])]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;Data for N&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">forest</span><span class="o">.</span><span class="n">subtree</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;Data for O&quot;</span><span class="p">)</span>
<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">),</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for N&#39;</span><span class="p">},</span> <span class="n">root</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
</div>
<pre>A
├───── B
│      └───── H
├───── C
│      ├───── D
│      ├───── E
│      │      ├───── F
│      │      └───── G
│      │             ├───── K
│      │             └───── L
│      └───── M
├───── I
│      └───── J
├───── N
└───── O 🟡
</pre><p>If we try too add a non-unique node key to the tree, we will get a
<code class="docutils literal notranslate"><span class="pre">KeyError</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">forest</span><span class="o">.</span><span class="n">subtree</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;key already exists in the tree: B&#39;</span>
</pre></div>
</div>
<p>Let’s add some more nodes.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;Data for P&quot;</span><span class="p">)</span>
<span class="n">N</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;Data for Q&quot;</span><span class="p">)</span>
<span class="n">P</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;Data for R&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;Data for S&quot;</span>
<span class="p">)</span>
<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
</pre></div>
</div>
<pre>A
├───── B
│      └───── H
├───── C
│      ├───── D
│      ├───── E
│      │      ├───── F
│      │      └───── G
│      │             ├───── K
│      │             └───── L
│      └───── M
├───── I
│      └───── J
├───── N ⭕
│      ├───── P 🟤
│      │      └───── R 🔵
│      │             └───── S 🟤
│      └───── Q 🔘
└───── O
</pre><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for A&#39;</span><span class="p">},</span> <span class="n">root</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">])</span>
<span class="kc">None</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_nodes</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">breadth_first_undirected</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">([</span><span class="n">n</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">f_nodes</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">subtree_rooted_at</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<pre>C ⭕
├───── D
├───── E
│      ├───── F
│      └───── G
└───── M
</pre><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">center_C</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">subtree_centered_at</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">center_C</span><span class="p">,</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]))</span>
<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<pre>A
├───── B
├───── C ⭕
│      ├───── D
│      ├───── E
│      │      ├───── F
│      │      └───── G
│      └───── M
├───── I
├───── N
└───── O
</pre><pre>A
├───── B
│      └───── H
├───── C ⭕
│      ├───── D
│      ├───── E
│      │      ├───── F
│      │      └───── G
│      │             ├───── K
│      │             └───── L
│      └───── M
├───── I
│      └───── J
├───── N
│      ├───── P
│      │      └───── R
│      │             └───── S
│      └───── Q
└───── O
</pre><p>We also support conversions to and from any tree-like structure that
supports the node-centric API, including <code class="docutils literal notranslate"><span class="pre">FlatForest</span></code> and a simple
(but far more flexible) <code class="docutils literal notranslate"><span class="pre">TreeNode</span></code> class that we also provide for
illustrative purposes.</p>
<p>The function is called <code class="docutils literal notranslate"><span class="pre">TreeConverter.copy_under</span></code> which accepts a
<code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">target</span></code> object, and copies the <code class="docutils literal notranslate"><span class="pre">source</span></code> object under
the <code class="docutils literal notranslate"><span class="pre">target</span></code> object. The source is normally a node of some kind, and
the target is another node, and the result is the tree structure under
the source node is copied under the target node. The source node is not
modified in any way.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">AlgoTree.treenode</span> <span class="kn">import</span> <span class="n">TreeNode</span>
<span class="n">treeNodeMe</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;treenode&quot;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for treenode&quot;</span><span class="p">})</span>
<span class="n">treeNodeMe</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;child1&quot;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for child1&quot;</span><span class="p">})</span>
<span class="n">treeNodeMe</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;child2&quot;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for child2&quot;</span><span class="p">})</span>
<span class="n">tree1</span> <span class="o">=</span> <span class="n">TreeConverter</span><span class="o">.</span><span class="n">copy_under</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">subtree</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">),</span> <span class="n">treeNodeMe</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">tree1</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;child1&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>treenode
├───── child1 🟡
│      └───── C
│             ├───── D
│             ├───── E
│             │      ├───── F
│             │      └───── G
│             │             ├───── K
│             │             └───── L
│             └───── M
└───── child2
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tree2</span> <span class="o">=</span> <span class="n">TreeConverter</span><span class="o">.</span><span class="n">copy_under</span><span class="p">(</span><span class="n">tree1</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">forest</span><span class="o">.</span><span class="n">subtree</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">),</span> <span class="n">node_name</span><span class="o">=</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_2&quot;</span><span class="p">)</span>
<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">tree2</span><span class="o">.</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
</pre></div>
</div>
<pre>A
├───── B
│      └───── H
├───── C
│      ├───── D
│      │      └───── treenode_2
│      │             ├───── child1_2
│      │             │      └───── C_2
│      │             │             ├───── D_2
│      │             │             ├───── E_2
│      │             │             │      ├───── F_2
│      │             │             │      └───── G_2
│      │             │             │             ├───── K_2
│      │             │             │             └───── L_2
│      │             │             └───── M_2
│      │             └───── child2_2
│      ├───── E
│      │      ├───── F
│      │      └───── G
│      │             ├───── K
│      │             └───── L
│      └───── M
├───── I
│      └───── J
├───── N
│      ├───── P
│      │      └───── R
│      │             └───── S
│      └───── Q
└───── O
</pre><p>We can iterate over the items of the child and we can modify/delete its
data.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">forest</span><span class="o">.</span><span class="n">subtree</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s2">&quot;&lt;--&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

<span class="n">N</span><span class="p">[</span><span class="s2">&quot;new_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Some new data for G&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="k">del</span> <span class="n">N</span><span class="p">[</span><span class="s2">&quot;new_data&quot;</span><span class="p">]</span>
<span class="n">N</span><span class="p">[</span><span class="s2">&quot;other_new_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Some other data for G&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">&lt;--</span> <span class="n">Data</span> <span class="k">for</span> <span class="n">N</span>
<span class="n">parent</span> <span class="o">&lt;--</span> <span class="n">A</span>
<span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for N&#39;</span><span class="p">,</span> <span class="s1">&#39;new_data&#39;</span><span class="p">:</span> <span class="s1">&#39;Some new data for G&#39;</span><span class="p">},</span> <span class="n">root</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">])</span>
<span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for N&#39;</span><span class="p">,</span> <span class="s1">&#39;other_new_data&#39;</span><span class="p">:</span> <span class="s1">&#39;Some other data for G&#39;</span><span class="p">},</span> <span class="n">root</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Let’s create a tree from a dictionary that refers to a non-existent
parent.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">non_existent_parent_tree</span> <span class="o">=</span> <span class="n">FlatForest</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;non_existent_parent&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for A&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">FlatForest</span><span class="o">.</span><span class="n">check_valid</span><span class="p">(</span><span class="n">non_existent_parent_tree</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;Parent &#39;non_existent_parent&#39; not in forest for node &#39;A&#39;&quot;</span>
</pre></div>
</div>
<p>We see that the node is disconnected from the logical root, since it
refers to a non-existent parent.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">cycle_tree</span> <span class="o">=</span> <span class="n">FlatForest</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for x&quot;</span><span class="p">},</span>
            <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for A&quot;</span><span class="p">},</span>
            <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for B&quot;</span><span class="p">},</span>
            <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for C&quot;</span><span class="p">},</span>
            <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for D&quot;</span><span class="p">},</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">cycle_tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
    <span class="n">FlatForest</span><span class="o">.</span><span class="n">check_valid</span><span class="p">(</span><span class="n">cycle_tree</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<pre>x
└───── D
</pre><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Cycle</span> <span class="n">detected</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>We see that the tree was in an invalid state. In particular, nodes 1, 2,
and 3 are from any root and in a cycle. We can fix this by breaking the
cycle and setting the parent of node 3 to, for instance, to <code class="docutils literal notranslate"><span class="pre">x</span></code>.
However, we can also fix it by setting the parent to <code class="docutils literal notranslate"><span class="pre">None</span></code>, so that
it is a seperate tree in the forest.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_tree</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s2">&quot;parent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">FlatForest</span><span class="o">.</span><span class="n">check_valid</span><span class="p">(</span><span class="n">cycle_tree</span><span class="p">)</span>
<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">cycle_tree</span><span class="o">.</span><span class="n">subtree</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">),</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cycle_tree</span><span class="o">.</span><span class="n">root_names</span><span class="p">)</span>
</pre></div>
</div>
<pre>C ⭕
└───── A
       └───── B
</pre><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;__DETACHED__&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Let’s look at the tree again, and see about creating a cycle.</p>
<p>We will make node 1 the parent of node 5, to create a cycle:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">new_tree</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
    <span class="n">new_tree</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)[</span><span class="s2">&quot;parent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;E&quot;</span>
    <span class="n">FlatForest</span><span class="o">.</span><span class="n">check_valid</span><span class="p">(</span><span class="n">new_tree</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">a</span> <span class="n">dictionary</span><span class="p">:</span> <span class="n">data</span><span class="o">=</span><span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for A&#39;</span><span class="p">},</span> <span class="n">root</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Notice that we use <code class="docutils literal notranslate"><span class="pre">deepcopy</span></code> to avoid modifying the original tree
with these invalid operations. We chose to do it this way so as to not
incur the overhead of reverting the tree to a valid state after an
invalid operation. This way, we can keep the tree in an invalid state
for as long as we want, and only revert it to a valid state when we want
to.</p>
<p>Each node is a key-value pair in the <code class="docutils literal notranslate"><span class="pre">FlatForest</span></code>. We have the
<code class="docutils literal notranslate"><span class="pre">FlatForestNode</span></code> so that we can have an API focused on the nodes and
not the underlying dictionary. However, we stiill permit access to the
underlying dictionary. When you modify the tree in this way, we still
maintain the integrity of the tree.</p>
<p>Since the <code class="docutils literal notranslate"><span class="pre">FlatForest</span></code> represents nodes as key-value pairs, and the
value may have a parent key, along with any other arbitrary data, each
value for a node must be a dictionary.</p>
<p>Below, we see that trying to add a <code class="docutils literal notranslate"><span class="pre">test</span></code> node with a non-dictionary
value generates an error.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">error_tree</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">forest</span><span class="p">)</span>
    <span class="c1"># this will raise a ValueError because the node with key `test` maps to</span>
    <span class="c1"># string instead of a dict.</span>
    <span class="n">error_tree</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Some test data&quot;</span>
    <span class="n">FlatForest</span><span class="o">.</span><span class="n">check_valid</span><span class="p">(</span><span class="n">error_tree</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Node</span> <span class="s1">&#39;test&#39;</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">have</span> <span class="n">a</span> <span class="n">payload</span> <span class="n">dictionary</span><span class="p">:</span> <span class="s1">&#39;Some test data&#39;</span>
</pre></div>
</div>
<p>Let’s manipulate the tree a bit more using the <code class="docutils literal notranslate"><span class="pre">dict</span></code> API. We’re just
going to add a <code class="docutils literal notranslate"><span class="pre">new_node</span></code> with some data.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forest</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for T&quot;</span>
<span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">subtree</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">),</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>FlatForestNode(name=T, parent=B, payload={&#39;data&#39;: &#39;Data for T&#39;}, root=A, children=[])
B
├───── H
└───── T 🔵
</pre></div>
</div>
<p>Logical roots are not a part of the underlying dictionary, so we can’t
access it through the <code class="docutils literal notranslate"><span class="pre">dict</span></code> API. It’s non-children data are also
immutable through the <code class="docutils literal notranslate"><span class="pre">FlatForestNode</span></code> API. Right now, we use
<code class="docutils literal notranslate"><span class="pre">FlatForest.DETACHED_KEY</span></code> as a logical root for detached nodes.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">detached</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">__DETACHED__</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{},</span> <span class="n">root</span><span class="o">=</span><span class="n">__DETACHED__</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
</div>
<p>We see that there are no detached nodes in the forest right now.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">forest</span><span class="o">.</span><span class="n">detached</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Some new data for root node&quot;</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">forest</span><span class="o">.</span><span class="n">detached</span><span class="p">[</span><span class="s2">&quot;parent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">__DETACHED__</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">immutable</span> <span class="n">logical</span> <span class="n">root</span>
<span class="n">__DETACHED__</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">immutable</span> <span class="n">logical</span> <span class="n">root</span>
</pre></div>
</div>
<p>We can <em>detach</em> nodes. Let’s first view the full tree, pre-detachment.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
</pre></div>
</div>
<pre>A
├───── B
│      ├───── H
│      └───── T
├───── C
│      ├───── D
│      │      └───── treenode_2
│      │             ├───── child1_2
│      │             │      └───── C_2
│      │             │             ├───── D_2
│      │             │             ├───── E_2
│      │             │             │      ├───── F_2
│      │             │             │      └───── G_2
│      │             │             │             ├───── K_2
│      │             │             │             └───── L_2
│      │             │             └───── M_2
│      │             └───── child2_2
│      ├───── E
│      │      ├───── F
│      │      └───── G
│      │             ├───── K
│      │             └───── L
│      └───── M
├───── I
│      └───── J
├───── N
│      ├───── P
│      │      └───── R
│      │             └───── S
│      └───── Q
└───── O
</pre><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forest</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
<span class="n">forest</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="s2">&quot;G&quot;</span><span class="p">)</span>
<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
</pre></div>
</div>
<pre>A
├───── B
│      ├───── H
│      └───── T
├───── C
│      ├───── E
│      │      └───── F
│      └───── M
├───── I
│      └───── J
├───── N
│      ├───── P
│      │      └───── R
│      │             └───── S
│      └───── Q
└───── O
</pre><p>Let’s view the detached tree.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">detached</span><span class="p">,</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<pre>__DETACHED__
├───── D
│      └───── treenode_2
│             ├───── child1_2
│             │      └───── C_2
│             │             ├───── D_2
│             │             ├───── E_2
│             │             │      ├───── F_2
│             │             │      └───── G_2
│             │             │             ├───── K_2
│             │             │             └───── L_2
│             │             └───── M_2
│             └───── child2_2
└───── G
       ├───── K
       └───── L
</pre><p>We can purge detached nodes (and their descendants) from the tree with
the <code class="docutils literal notranslate"><span class="pre">purge</span></code> method. Let’s purge the detached nodes. Note that when we
do this, through the node-centric API, nothing will seem different
(unless we look at the tree rooted at the detached logical root).
However, if we look at the underlying dictionary, we will see that the
detached nodes are gone.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forest</span><span class="o">.</span><span class="n">purge</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">forest</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="n">null</span>
  <span class="p">},</span>
  <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;3&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;4&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;5&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for A&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="n">null</span>
  <span class="p">},</span>
  <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for B&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for C&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;E&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for E&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;F&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for F&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;E&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for H&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;I&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for I&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;J&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for J&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;I&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;M&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for M&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for N&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
    <span class="s2">&quot;other_new_data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some other data for G&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;O&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for O&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;P&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for P&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;N&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;Q&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for Q&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;N&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;R&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for R&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;P&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for S&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;R&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;T&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for T&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We have a fairly complete API for manipulating the forest. Let’s explore
some additional methods. Let’s first create a node itrator to node A,
and then access or modify the payload data for node A. Since payload
data is mutable, and it must be a dictionary, we can access or modify it
using the dict API.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forest</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">forest</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)[</span><span class="s2">&quot;new_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Some new data for A&quot;</span>
<span class="n">forest</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)[</span><span class="s2">&quot;other_new_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Some other data for A&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">forest</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;new_data&#39;</span><span class="p">:</span> <span class="s1">&#39;Some new data for A&#39;</span><span class="p">,</span> <span class="s1">&#39;other_new_data&#39;</span><span class="p">:</span> <span class="s1">&#39;Some other data for A&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>This is fairly self-expalanatory.</p>
<p>Let’s add some more nodes without specifying a key name for them, since
often we don’t care about the key name and it’s only for bookkeeping
purposes.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">whatever</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;U&quot;</span><span class="p">,</span> <span class="n">whatever</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">whatever</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="mi">779</span><span class="n">cc759</span><span class="o">-</span><span class="mi">36</span><span class="n">a9</span><span class="o">-</span><span class="mi">4</span><span class="n">dae</span><span class="o">-</span><span class="n">a1c9</span><span class="o">-</span><span class="n">e021d65aa1d4</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">U</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;whatever&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span> <span class="n">root</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FlatForestNode</span><span class="p">(</span><span class="n">whatever</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="n">whatever</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">FlatForestNode</span><span class="p">(</span><span class="n">whatever</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">more_data</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">forest</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;V&quot;</span><span class="p">))</span>
<span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">whatever</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;whatever&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">},</span> <span class="n">root</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forest</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;V&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">forest</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;W&quot;</span><span class="p">)</span>
<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;U&quot;</span><span class="p">,</span> <span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="s2">&quot;W&quot;</span><span class="p">],</span> <span class="n">node_details</span><span class="o">=</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="o">.</span><span class="n">payload</span><span class="p">))</span>
</pre></div>
</div>
<pre>A ◄ {'new_data': 'Some new data for A', 'other_new_data': 'Some other data for A'}
├───── B ◄ {'data': 'Data for B'}
│      ├───── H ◄ {'data': 'Data for H'}
│      ├───── T ◄ {'data': 'Data for T'}
│      └───── d433395a-27bc-457d-b6d9-c7034d020978 ◄ {'whatever': 1000}
├───── C ◄ {'data': 'Data for C'}
│      ├───── E ◄ {'data': 'Data for E'}
│      │      └───── F ◄ {'data': 'Data for F'}
│      └───── M ◄ {'data': 'Data for M'}
├───── I ◄ {'data': 'Data for I'}
│      └───── J ◄ {'data': 'Data for J'}
├───── N ◄ {'data': 'Data for N', 'other_new_data': 'Some other data for G'}
│      ├───── P ◄ {'data': 'Data for P'}
│      │      └───── R ◄ {'data': 'Data for R'}
│      │             └───── S ◄ {'data': 'Data for S'}
│      └───── Q ◄ {'data': 'Data for Q'}
├───── O ◄ {'data': 'Data for O'}
├───── 945ef525-fece-45f0-a499-b5449d28ef1e ◄ {'whatever': 3}
│      └───── U ◄ {'whatever': 4} 🔴
│             └───── 779cc759-36a9-4dae-a1c9-e021d65aa1d4 ◄ {'whatever': 5}
└───── W ◄ {'whatever': 200} ⚫
       └───── V ◄ {'whatever': 2000} 🔘
              └───── 14e057df-8004-47c3-9415-b7c7235ea4d8 ◄ {'whatever': 3000, 'more_data': 'yes'}
</pre><p>Let’s look at some tree conversions. We can convert between different
tree representations and data structures.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_tree</span> <span class="o">=</span> <span class="n">TreeConverter</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">TreeNode</span><span class="p">)</span>
<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">new_tree</span><span class="p">,</span> <span class="n">node_details</span><span class="o">=</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="o">.</span><span class="n">payload</span><span class="p">))</span>
</pre></div>
</div>
<pre>A ◄ {'new_data': 'Some new data for A', 'other_new_data': 'Some other data for A'}
├───── B ◄ None
│      ├───── H ◄ None
│      ├───── T ◄ None
│      └───── d433395a-27bc-457d-b6d9-c7034d020978 ◄ None
├───── C ◄ None
│      ├───── E ◄ None
│      │      └───── F ◄ None
│      └───── M ◄ None
├───── I ◄ None
│      └───── J ◄ None
├───── N ◄ None
│      ├───── P ◄ None
│      │      └───── R ◄ None
│      │             └───── S ◄ None
│      └───── Q ◄ None
├───── O ◄ None
├───── 945ef525-fece-45f0-a499-b5449d28ef1e ◄ None
│      └───── U ◄ None
│             └───── 779cc759-36a9-4dae-a1c9-e021d65aa1d4 ◄ None
└───── W ◄ None
       └───── V ◄ None
              └───── 14e057df-8004-47c3-9415-b7c7235ea4d8 ◄ None
</pre><p>We see that it’s a different type of tree, a <code class="docutils literal notranslate"><span class="pre">TreeNode</span></code>, which is a
recursive data structure. It models the same tree data, but in a
different way. This one is also more flexible, so that it doesn’t
require unique names or the payload data to be a dictionary - it can be
any object or value. This simplicity comes at the cost of not being a
dictionary (or view of a dictionary), as FlatForest does.</p>
<p>We see that it has a very different structure. However, when we
pretty-print it using <code class="docutils literal notranslate"><span class="pre">TreeViz</span></code>, we see that it’s the same tree.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">new_tree</span><span class="p">))</span>
</pre></div>
</div>
<pre>A
├───── B
│      ├───── H
│      ├───── T
│      └───── d433395a-27bc-457d-b6d9-c7034d020978
├───── C
│      ├───── E
│      │      └───── F
│      └───── M
├───── I
│      └───── J
├───── N
│      ├───── P
│      │      └───── R
│      │             └───── S
│      └───── Q
├───── O
├───── 945ef525-fece-45f0-a499-b5449d28ef1e
│      └───── U
│             └───── 779cc759-36a9-4dae-a1c9-e021d65aa1d4
└───── W
       └───── V
              └───── 14e057df-8004-47c3-9415-b7c7235ea4d8
</pre><pre>A
├───── B
│      ├───── H
│      ├───── T
│      └───── d433395a-27bc-457d-b6d9-c7034d020978
├───── C
│      ├───── E
│      │      └───── F
│      └───── M
├───── I
│      └───── J
├───── N
│      ├───── P
│      │      └───── R
│      │             └───── S
│      └───── Q
├───── O
├───── 945ef525-fece-45f0-a499-b5449d28ef1e
│      └───── U
│             └───── 779cc759-36a9-4dae-a1c9-e021d65aa1d4
└───── W
       └───── V
              └───── 14e057df-8004-47c3-9415-b7c7235ea4d8
</pre><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">TreeConverter</span><span class="o">.</span><span class="n">copy_under</span><span class="p">(</span><span class="n">new_tree</span><span class="p">,</span> <span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;new_root&quot;</span><span class="p">))</span>
<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
<span class="n">result2</span> <span class="o">=</span> <span class="n">TreeConverter</span><span class="o">.</span><span class="n">copy_under</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">new_tree</span><span class="p">)</span>
<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">result2</span><span class="p">))</span>
</pre></div>
</div>
<pre>A
├───── B
│      ├───── H
│      ├───── T
│      └───── d433395a-27bc-457d-b6d9-c7034d020978
├───── C
│      ├───── E
│      │      └───── F
│      └───── M
├───── I
│      └───── J
├───── N
│      ├───── P
│      │      └───── R
│      │             └───── S
│      └───── Q
├───── O
├───── 945ef525-fece-45f0-a499-b5449d28ef1e
│      └───── U
│             └───── 779cc759-36a9-4dae-a1c9-e021d65aa1d4
└───── W
       └───── V
              └───── 14e057df-8004-47c3-9415-b7c7235ea4d8
</pre><pre>A
├───── B
│      ├───── H
│      ├───── T
│      └───── d433395a-27bc-457d-b6d9-c7034d020978
├───── C
│      ├───── E
│      │      └───── F
│      └───── M
├───── I
│      └───── J
├───── N
│      ├───── P
│      │      └───── R
│      │             └───── S
│      └───── Q
├───── O
├───── 945ef525-fece-45f0-a499-b5449d28ef1e
│      └───── U
│             └───── 779cc759-36a9-4dae-a1c9-e021d65aa1d4
└───── W
       └───── V
              └───── 14e057df-8004-47c3-9415-b7c7235ea4d8
</pre><p>The <code class="docutils literal notranslate"><span class="pre">TreeNode</span></code> is a bit more useful for operations that require
recursion, but any tree can support the sae operations. The <code class="docutils literal notranslate"><span class="pre">TreeNode</span></code>
is a bit more specialized for this purpose, and the <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> is a
bit more specialized for more general storage and manipulation of data
that is tree-like, such as configuration data or log data. See
<code class="docutils literal notranslate"><span class="pre">TreeNode.md</span></code> for more information on the <code class="docutils literal notranslate"><span class="pre">TreeNode</span></code> class.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">root</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">root2</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">A2</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root2</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">B2</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root2</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">C2</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root2</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">D2</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C2</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">E2</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C2</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">F2</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C2</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="n">G2</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C2</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">H2</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C2</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
<span class="n">I2</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">F2</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">root2</span><span class="p">,</span> <span class="n">node_details</span><span class="o">=</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="o">.</span><span class="n">payload</span><span class="p">))</span>
</pre></div>
</div>
<pre>root ◄ 0
├───── A ◄ 1
├───── B ◄ 2
└───── C ◄ 3
       ├───── D ◄ 4
       ├───── E ◄ 5
       ├───── F ◄ test
       │      └───── I ◄ 9
       ├───── G ◄ 7
       └───── H ◄ ({1: 2}, [3, 4])
</pre><section id="algorithm-examples">
<h2>Algorithm Examples<a class="headerlink" href="#algorithm-examples" title="Link to this heading">¶</a></h2>
<p>Using utility algorithms with <code class="docutils literal notranslate"><span class="pre">FlatTree</span></code> and <code class="docutils literal notranslate"><span class="pre">FlatTreeNode</span></code>:</p>
<p>Finding descendants of a node:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">AlgoTree.utils</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">descendants</span><span class="p">(</span><span class="n">C</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">E</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for E&#39;</span><span class="p">},</span> <span class="n">root</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">]),</span>
 <span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">F</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">E</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for F&#39;</span><span class="p">},</span> <span class="n">root</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[]),</span>
 <span class="n">FlatForestNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;Data for M&#39;</span><span class="p">},</span> <span class="n">root</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[])]</span>
</pre></div>
</div>
<p>Finding ancestors of a node:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">ancestors</span><span class="p">(</span><span class="n">I2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">F</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="n">test</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
 <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">)</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
 <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">)</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
</pre></div>
</div>
<p>Finding siblings of a node:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">siblings</span><span class="p">(</span><span class="n">E2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[]</span>
</pre></div>
</div>
<p>Finding leaves of a node:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">leaves</span><span class="p">(</span><span class="n">root2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
 <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">B</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
 <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">D</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
 <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">E</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
 <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">I</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">F</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
 <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">G</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
 <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">H</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span>
</pre></div>
</div>
<p>Finding the height of a tree:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">height</span><span class="p">(</span><span class="n">root2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span>
</pre></div>
</div>
<p>Finding the depth of a node:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">depth</span><span class="p">(</span><span class="n">F2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>
</pre></div>
</div>
<p>Breadth-first traversal:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">print_node</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">level</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Level </span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">False</span>

<span class="n">breadth_first</span><span class="p">(</span><span class="n">root2</span><span class="p">,</span> <span class="n">print_node</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Level</span> <span class="mi">0</span><span class="p">:</span> <span class="n">root</span>
<span class="n">Level</span> <span class="mi">1</span><span class="p">:</span> <span class="n">A</span>
<span class="n">Level</span> <span class="mi">1</span><span class="p">:</span> <span class="n">B</span>
<span class="n">Level</span> <span class="mi">1</span><span class="p">:</span> <span class="n">C</span>
<span class="n">Level</span> <span class="mi">2</span><span class="p">:</span> <span class="n">D</span>
<span class="n">Level</span> <span class="mi">2</span><span class="p">:</span> <span class="n">E</span>
<span class="n">Level</span> <span class="mi">2</span><span class="p">:</span> <span class="n">F</span>
<span class="n">Level</span> <span class="mi">2</span><span class="p">:</span> <span class="n">G</span>
<span class="n">Level</span> <span class="mi">2</span><span class="p">:</span> <span class="n">H</span>
<span class="n">Level</span> <span class="mi">3</span><span class="p">:</span> <span class="n">I</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">False</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">node_stats</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">)),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;node_info&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;class &#39;AlgoTree.flat_forest_node.FlatForestNode&#39;&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;N&quot;</span><span class="p">,</span>
    <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data for N&quot;</span><span class="p">,</span>
      <span class="s2">&quot;other_new_data&quot;</span><span class="p">:</span> <span class="s2">&quot;Some other data for G&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;P&quot;</span><span class="p">,</span>
      <span class="s2">&quot;Q&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
    <span class="s2">&quot;depth&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;is_root&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;is_leaf&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;is_internal&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;ancestors&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;A&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;siblings&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;B&quot;</span><span class="p">,</span>
      <span class="s2">&quot;C&quot;</span><span class="p">,</span>
      <span class="s2">&quot;I&quot;</span><span class="p">,</span>
      <span class="s2">&quot;O&quot;</span><span class="p">,</span>
      <span class="s2">&quot;945ef525-fece-45f0-a499-b5449d28ef1e&quot;</span><span class="p">,</span>
      <span class="s2">&quot;W&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;descendants&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;P&quot;</span><span class="p">,</span>
      <span class="s2">&quot;R&quot;</span><span class="p">,</span>
      <span class="s2">&quot;S&quot;</span><span class="p">,</span>
      <span class="s2">&quot;Q&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;A&quot;</span><span class="p">,</span>
      <span class="s2">&quot;N&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;root_distance&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;leaves_under&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;S&quot;</span><span class="p">,</span>
      <span class="s2">&quot;Q&quot;</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;subtree_info&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;leaves&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;H&quot;</span><span class="p">,</span>
      <span class="s2">&quot;T&quot;</span><span class="p">,</span>
      <span class="s2">&quot;d433395a-27bc-457d-b6d9-c7034d020978&quot;</span><span class="p">,</span>
      <span class="s2">&quot;F&quot;</span><span class="p">,</span>
      <span class="s2">&quot;M&quot;</span><span class="p">,</span>
      <span class="s2">&quot;J&quot;</span><span class="p">,</span>
      <span class="s2">&quot;S&quot;</span><span class="p">,</span>
      <span class="s2">&quot;Q&quot;</span><span class="p">,</span>
      <span class="s2">&quot;O&quot;</span><span class="p">,</span>
      <span class="s2">&quot;779cc759-36a9-4dae-a1c9-e021d65aa1d4&quot;</span><span class="p">,</span>
      <span class="s2">&quot;14e057df-8004-47c3-9415-b7c7235ea4d8&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;root&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
    <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">5</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Mapping a function over the nodes:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_prefix</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;D&quot;</span><span class="p">:</span>
        <span class="c1"># add Q and R as children of D</span>
        <span class="n">node</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">41</span><span class="p">)</span>
        <span class="n">node</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;I&quot;</span> <span class="ow">or</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;W&quot;</span><span class="p">:</span>
        <span class="c1"># delete I by returning None (i.e. don&#39;t add it to the new tree)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="s2">&quot;U&quot;</span> <span class="ow">in</span> <span class="p">[</span><span class="n">child</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">]:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">node</span>

<span class="n">root_mapped</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="p">),</span> <span class="n">add_prefix</span><span class="p">)</span>

<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">root_mapped</span><span class="p">))</span>

<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">forest</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
</pre></div>
</div>
<pre>A
├───── B
│      ├───── H
│      ├───── T
│      └───── d433395a-27bc-457d-b6d9-c7034d020978
├───── C
│      ├───── E
│      │      └───── F
│      └───── M
├───── N
│      ├───── P
│      │      └───── R
│      │             └───── S
│      └───── Q
└───── O
</pre><pre>A
├───── B
│      ├───── H
│      ├───── T
│      └───── d433395a-27bc-457d-b6d9-c7034d020978
├───── C
│      ├───── E
│      │      └───── F
│      └───── M
├───── I
│      └───── J
├───── N
│      ├───── P
│      │      └───── R
│      │             └───── S
│      └───── Q
├───── O
├───── 945ef525-fece-45f0-a499-b5449d28ef1e
│      └───── U
│             └───── 779cc759-36a9-4dae-a1c9-e021d65aa1d4
└───── W
       └───── V
              └───── 14e057df-8004-47c3-9415-b7c7235ea4d8
</pre><p>Pruning nodes based on a predicate:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">should_prune</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;A&quot;</span>

<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">root2</span><span class="p">))</span>
<span class="n">pruned_tree</span> <span class="o">=</span> <span class="n">prune</span><span class="p">(</span><span class="n">root2</span><span class="p">,</span> <span class="n">should_prune</span><span class="p">)</span>
<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">pruned_tree</span><span class="p">))</span>
</pre></div>
</div>
<pre>root
├───── A
├───── B
└───── C
       ├───── D
       ├───── E
       ├───── F
       │      └───── I
       ├───── G
       └───── H
</pre><pre>root
├───── B
└───── C
       ├───── D
       ├───── E
       ├───── F
       │      └───── I
       ├───── G
       └───── H
</pre><p>Finding root-to-leaf paths:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="n">paths</span> <span class="o">=</span> <span class="n">node_to_leaf_paths</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="c1"># print max path length from root to leaf</span>
<span class="n">pprint</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
 <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span>
<span class="kc">True</span>
</pre></div>
</div>
<p>Converting paths to a tree:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rooter</span> <span class="o">=</span> <span class="n">paths_to_tree</span><span class="p">([[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
                        <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span> <span class="p">],</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">],</span>
                        <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;j&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;j&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">],</span>
                        <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;j&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]],</span>
                        <span class="n">FlatForestNode</span><span class="p">)</span>
<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">rooter</span><span class="p">))</span>
</pre></div>
</div>
<pre>a
├───── b
│      ├───── c
│      └───── d
├───── e
│      ├───── d_0
│      ├───── g
│      └───── h
├───── f
│      └───── d_1
└───── i
       └───── j
              ├───── b_0
              │      └───── m
              └───── l
                     └───── b_1
                            └───── b_2
                                   └───── b_3
                                          └───── b_4
                                                 └───── b_5
                                                        └───── b_6
                                                               └───── t
                                                                      └───── u
                                                                             └───── v
                                                                                    └───── w
                                                                                           └───── x
                                                                                                  └───── y
                                                                                                         └───── b_7
</pre><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">AlgoTree.utils</span> <span class="kn">import</span> <span class="n">depth</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">ancestors</span><span class="p">,</span> <span class="n">siblings</span><span class="p">,</span> <span class="n">is_root</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">rooter</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;i&quot;</span><span class="p">)</span>
<span class="n">pretty_tree</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">depth</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">([</span><span class="n">n</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">path</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
<span class="nb">print</span><span class="p">([</span><span class="n">n</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">ancestors</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">siblings</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">is_root</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>
<span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;b_0&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="p">[]</span>
<span class="kc">False</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">treenode</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">treenode</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">treenode</span><span class="p">)</span>
<span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
<span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>

<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">treenode</span><span class="p">))</span>
</pre></div>
</div>
<pre>A
├───── B
└───── C
       ├───── D
       └───── E
</pre><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">treenode_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span><span class="p">},</span>
            <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;E&quot;</span><span class="p">}</span>
        <span class="p">]}</span>
    <span class="p">]}</span>

<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">treenode_dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">treenode</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
  <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>
      <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;E&quot;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
  <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span>
      <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>
      <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span>
          <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span>
          <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">treenode_from_dict</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">treenode_dict</span><span class="p">)</span>
<span class="n">monotext</span><span class="p">(</span><span class="n">pretty_tree</span><span class="p">(</span><span class="n">treenode_from_dict</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">treenode_from_dict</span> <span class="o">==</span> <span class="n">treenode</span><span class="p">)</span>
</pre></div>
</div>
<pre>A
├───── B
└───── C
       ├───── D
       └───── E
</pre><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">FlatForest</span></code> class provides a powerful and flexible way to work
with tree-like and forest-like data structures using a flat dictionary
structure. It supports a wide range of operations, including node
manipulation, tree traversal, detachment, pruning, and conversion
between different tree representations.</p>
<p>Explore the <code class="docutils literal notranslate"><span class="pre">AlgoTree</span></code> package further to discover more features and
utilities for working with trees in Python.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">FlatForest</span> <span class="pre">Notebook</span></code></a><ul>
<li><a class="reference internal" href="#algorithm-examples">Algorithm Examples</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="tutorial.html"
                          title="previous chapter">AlgoTree: Comprehensive Tutorial</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="expr_trees_nb.html"
                          title="next chapter">Expression Trees and Evaluation</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/flat_forest_nb.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="expr_trees_nb.html" title="Expression Trees and Evaluation"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="AlgoTree: Comprehensive Tutorial"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">AlgoTree 0.8.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="docutils literal notranslate"><span class="pre">FlatForest</span> <span class="pre">Notebook</span></code></a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Alex Towell.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    </div>
  </body>
</html>